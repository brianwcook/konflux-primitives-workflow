# Bootstrap - Core Data Files

This directory contains the core data files and results from the bootstrap process that created the complete OCI RPM repository.

## Files

### Input Specification
- **`rpms.lockfile.in`** - Base package specification (37 packages)
  - Standard rpm-lockfile-prototype input format
  - Specifies core Fedora packages for a minimal system
  - Used as input for dependency resolution

### Resolved Dependencies  
- **`complete-deps.lockfile.yaml`** - Complete dependency resolution (214 unique packages)
  - Generated by rpm-lockfile-prototype against Fedora rawhide
  - Contains 427 total RPM entries (214 packages × 2 architectures)
  - Standard lockfile format with HTTP URLs to Fedora repos

### Downloaded RPMs
- **`hermeto-output/`** - Complete RPM archive (427 files)
  - Downloaded using hermeto for hermetic builds
  - Organized by architecture: `deps/rpm/{aarch64,x86_64}/fedora-rawhide/`
  - Includes SBOM generation for supply chain security

## Data Statistics

| Metric | Count | Description |
|--------|-------|-------------|
| **Base packages** | 37 | Packages specified in `rpms.lockfile.in` |
| **Resolved packages** | 214 | Unique packages after dependency resolution |
| **Total RPMs** | 427 | 214 packages × 2 architectures + noarch |
| **Downloaded files** | 427 | All RPMs stored in `hermeto-output/` |
| **OCI artifacts** | 591 | RPMs + indexes + metadata in Quay registry |

## Process Overview

The bootstrap process followed these steps:

1. **Package Specification** → `rpms.lockfile.in` (37 base packages)
2. **Dependency Resolution** → `complete-deps.lockfile.yaml` (214 packages)  
3. **Hermetic Download** → `hermeto-output/` (427 RPMs)
4. **OCI Upload** → `quay.io/bcook/rpms` (591 artifacts)
5. **Metadata Generation** → DNF repository structure
6. **Metadata Upload** → OCI metadata and cache artifacts

## Usage

These files serve as the foundation for the OCI RPM compose system:

### Using the Complete Lockfile
```bash
# Copy the complete dependency-resolved lockfile
cp complete-deps.lockfile.yaml my-project.lockfile.yaml

# Transform to OCI references
python3 ../lockfile/transform-lockfile.py \
  ../compose/fedora-complete-compose.yaml \
  my-project.lockfile.yaml \
  my-project-oci.lockfile.yaml
```

### Using the Base Specification
```bash
# Use as template for your own package set
cp rpms.lockfile.in my-packages.lockfile.in

# Edit to include your desired packages
# Then run rpm-lockfile-prototype when available:
# rpm-lockfile-prototype my-packages.lockfile.in > resolved.lockfile.yaml
```

## Character Sanitization

The bootstrap process discovered packages with OCI-invalid characters:
- **`libstdc++`** → Sanitized to `libstdc--` for OCI compliance
- **`python3` version `3.14.0~rc2`** → Sanitized to `python3-3.14.0-rc2`

The compose file maintains the mapping between original DNF names and sanitized OCI references.

## System Integration

This bootstrap directory provides the foundation data for:
- **Dependency resolution** - Complete lockfile with all dependencies
- **Hermetic builds** - Downloaded RPMs ready for offline use  
- **OCI transformation** - Source data for lockfile transformation
- **Compose management** - Package inventory for compose file generation

All data in this directory is production-ready and forms the basis of a complete, functional OCI-based RPM compose system.